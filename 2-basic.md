# アセンブリ言語の基本

## シンタックスの紹介

シンタックスとは、ある言語における文の構造、すなわち、その言語の文法規則のことを指します。プログラミング言語においては、コードが正しく動作するために従わなければならない正確なルールや形式を示します。これには、命令の書き方、変数の宣言、オペレータの使用方法、文の終わりを示す記号（例えばセミコロン;）などが含まれます。

プログラミング言語のシンタックスは、その言語でプログラムを書く際の「文法」と考えることができ、正しいシンタックスを使用しないと、コンパイラやインタープリタはコードを理解できず、エラーが発生します。

アセンブリ言語におけるシンタックスは、特に厳密であり、CPUが実行可能な命令セットを人間が読み書きしやすい形式で記述するためのルールを定めています。各アセンブリ言語の命令は、特定のシンタックスに従って記述され、CPUによる直接的な命令実行を可能にします。

シンタックスの正確な理解は、効果的でバグの少ないプログラミングに不可欠です。特にアセンブリ言語のような低レベル言語では、シンタックスの規則に厳密に従うことで、ハードウェアのリソースを直接制御し、最適化されたプログラムを作成することが可能になります。

アセンブリ言語は、特定のCPUアーキテクチャに依存しており、ここではIntel x86アーキテクチャを使用しています。NASM（Netwide Assembler）を用いたアセンブリ言語の基本的なシンタックスを紹介します。

### 命令フォーマット
アセンブリ言語の基本的な命令フォーマットは、以下のようになります：

 ```asm
[ラベル:] 命令 [オペランド1 [, オペランド2 [...]]] [;コメント]
```
- ラベル：
	- プログラム内の特定の位置を示すための識別子。任意で、命令の実行には影響しません。
- 命令：
	- CPUが実行するアクションを指定します。
- オペランド：
	- 命令によって操作されるデータ（レジスタ、メモリアドレス、定数など）。
- コメント：
	- `;`に続けて記述され、プログラムの読みやすさを向上させるための説明文。実行には影響しません。
### 基本的な命令例

データ転送命令（MOV）：
```asm
MOV AX, 1 ; AXレジスタに1を代入
```
算術命令（ADD, SUB）：
```asm
ADD AX, BX ; AXにBXを加える
SUB AX, BX ; AXからBXを引く
```
分岐命令（JMP, JE）：
```asm
JMP 無条件ジャンプ ; 無条件で指定したラベルへジャンプ
JE 条件ジャンプ ; 二つの値が等しい場合にジャンプ
```
コメント：
```asm
; これはコメントです
```

### プログラムの構造
アセンブリ言語のプログラムは、一連の命令で構成されます。NASMでは、プログラムの開始を示すセクション（.data、.bss、.textなど）を定義することが一般的です。

- データセクション（.data）：
	- 初期化されたデータ（変数や定数）を保持します。
- BSSセクション（.bss）：
	- 未初期化のデータ（変数）を宣言します。
- テキストセクション（.text）：
	- プログラムの実行命令を含みます。通常、プログラムのエントリーポイント（_start）もここで定義します。
```asm
section .data
    message db 'Hello, world!', 0

section .bss
    buffer resb 128

section .text
global _start
_start:
    ; ここにプログラムの命令が続く
```

アセンブリ言語のシンタックスを理解することは、低レベルプログラミングの基礎を学ぶ上で不可欠です。NASMを使ったアセンブリ言語プログラミングでは、これらの概念を適用して、CPUの動作を直接制御するプログラムを作成することが可能になります。

## 基本的な命令（MOV, ADD, SUB等）

アセンブリ言語のプログラミングにおいて、最も基本的かつ頻繁に使用される命令は、データの転送、算術演算、およびデータの比較などを行うものです。ここでは、Intel x86アーキテクチャをターゲットとしたNASMアセンブラを使用して、MOV、ADD、SUBといった基本的な命令について説明します。

### MOV命令
MOV命令は、データをレジスタ、メモリ、または即値（プログラム内で直接指定される値）間で転送するために使用されます。この命令は、データの値を変更せずに単純にコピーするので、「move」の名前が付いていますが、実際には「copy」の動作をします。

```asm
MOV destination, source
```
例：

```asm
MOV AX, 1    ; 即値1をレジスタAXにコピーします。
MOV BX, AX   ; AXの内容をBXにコピーします。
```

### ADD命令
ADD命令は、二つの値を加算し、結果を第一オペランド（通常はレジスタ）に格納します。この命令は、算術演算の基本であり、プログラム内で数値計算を行う際に頻繁に使用されます。

```asm
ADD destination, source
```
例：

```asm
ADD AX, BX   ; AXにBXを加え、結果をAXに格納します。
```

### SUB命令
SUB命令は、第二オペランドの値を第一オペランドの値から減算し、結果を第一オペランドに格納します。ADD命令と同様に、SUB命令も算術演算で広く使用されます。

```asm
SUB destination, source
```
例：

```asm
SUB AX, BX   ; AXからBXを引き、結果をAXに格納します。
```
これらの命令は、アセンブリ言語プログラミングの基礎を形成し、データ操作、計算処理、条件分岐など、さまざまなタスクを実行するための基盤となります。各命令は特定のシンタックスに従い、プログラムが正確に動作するように細心の注意を払って使用されます。アセンブリ言語でプログラムを作成する際には、これらの基本的な命令の正しい使用方法を理解し、適用することが非常に重要です。



## データ型とデータの扱い方

アセンブリ言語における「データ型」とは、プログラム内で扱うデータの種類やサイズを指します。高レベル言語とは異なり、アセンブリ言語ではデータ型が厳密に定義されているわけではありませんが、データを操作する際には、そのサイズや扱い方を正確に理解しておく必要があります。Intel x86アーキテクチャにおけるデータの扱い方について解説します。

### データサイズ

Intel x86アーキテクチャでは、データサイズに応じて異なるレジスタを使用します。主なデータサイズは以下の通りです：

- **バイト（8ビット）**：最も小さいデータサイズで、1文字のASCIIコードや小さな数値を格納するのに使用します。`AL`、`BL`などのレジスタが該当します。
- **ワード（16ビット）**：より大きな整数を格納するのに使用します。`AX`、`BX`などのレジスタが該当します。
- **ダブルワード（32ビット）**：32ビットの整数や、短い文字列、ポインタ（32ビットアーキテクチャの場合）を格納するのに使用します。`EAX`、`EBX`などのレジスタが該当します。
- **クアッドワード（64ビット）**：64ビットアーキテクチャにおいて、長い整数やポインタを格納するのに使用します。`RAX`、`RBX`などのレジスタが該当します。

### データ宣言

NASMにおいては、データセクション（`.data`）内でデータを宣言し、初期化することができます。データの種類に応じて、以下のディレクティブを使用します：

- **DB（Define Byte）**：1バイトのデータを定義します。
  ```asm
  myChar DB 'A' ; ASCIIコードで'A'を格納
  myNumber DB 0x1F ; 16進数で31を格納
  ```
- **DW（Define Word）**：2バイトのデータを定義します。
  ```asm
  myWord DW 0x1234 ; 16進数で4660を格納
  ```
- **DD（Define Doubleword）**：4バイトのデータを定義します。
  ```asm
  myDoubleWord DD 0x12345678 ; 16進数で305419896を格納
  ```
- **DQ（Define Quadword）**：8バイトのデータを定義します。
  ```asm
  myQuadWord DQ 0x123456789ABCDEF0 ; 64ビットの長い整数を格納
  ```

### データのアクセスと操作

データにアクセスするには、直接レジスタにロードするか、メモリアドレスを通じてアクセスします。データ操作には、`MOV`命令などが用いられ、演算には`ADD`、`SUB`などの算術命令が使用されます。重要なのは、操作するデータのサイズとレジスタが適合していることを確認することです。

アセンブリ言語におけるデータ型とデータの扱い方を理解することは、効率的でバグのないプログラム

を作成するために不可欠です。データのサイズとレジスタの選択を適切に行うことで、プログラムの性能を最適化し、システムリソースを効果的に利用することができます。


	
